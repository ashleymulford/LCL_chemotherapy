## Rome Semester work

# To Do List:
## Go through other populations and figure out what data is available, work towards expanding scope of project beyond YRI
  CEU - Central European, Utah USA
  YRI - Yoruba, Nigeria
  JPT - Japanese, Tokyo Japan
  ASW - African American, SW USA
  CHB - Han Chinese, Bejing China
  CHD - Han Chinese, Denver USA
## Analyze YRI results from gwas and predixcan
## Write up abstract, background, and proposal including objectives, methods, and budget.
## Sumbit grant and grad school applications


# Set up instructions:
## log into global protect
## mount with sftp net
## open R and set working directory
## terminal through putty as usually


# Population makeup: 
## analyze with R
  # Restock environment:
  ## pheno <- read.table(file = "master_cytotoxicity_info_130311_plus_igrowth.txt", header = TRUE)
  ## pheno_YRI <- subset(pheno, pop == "YRI")
  ## pheno_CHB <- subset(pheno, pop == "CHB")
  ## pheno_CHD <- subset(pheno, pop == "CHD")
  ## pheno_ASW <- subset(pheno, pop == "ASW")
  ## pheno_CEU <- subset(pheno, pop == "CEU")
  ## pheno_JPT <- subset(pheno, pop == "JPT")
  # Go through which pops have data for which drugs
## compile in google sheets
  
#ASN Population (CHB + JPT, does not include CHD)
 
#For asn: both pheno and fam had extra individuals, created two files.  
  
  ##used left_join to keep all individuals in fam file, including those we do not have pheno data on.
    ASN_pheno_ordered_allfam <- left_join(fam, asn, by = c("FID" = "FID", "IID" = "IID", "FatID" = "father", "MatID" = "mother", "Sex" = "sex"))
  ##used inner_join to keep only those which appear in both fam and pheno file.
    ASN_pheno_ordered <- inner_join(fam, asn, by = c("FID" = "FID", "IID" = "IID", "FatID" = "father", "MatID" = "mother", "Sex" = "sex"))
 
#made four pheno files:
  
  ##All individuals from fam file, with IDs:
    write.table(ASN_pheno_ordered_allfam_araclog2IC50, file = "ASN_ordered_pheno_allfam_araclog2IC50.txt", col.names = T, row.names = T, sep = "\t")
  ##Without IDS:
    write.table(ASN_pheno_ordered_allfam_araclog2IC50_noids, "ASN_ordered_pheno_allfam_araclog2IC50_noids.txt", col.names = F, row.names = F, sep = "\t")
  
  ##Individuals from fam with pheno data, with IDS:
    write.table(ASN_pheno_ordered_araclog2IC50, file = "ASN_ordered_pheno_araclog2IC50.txt", col.names = T, row.names = T, sep = "\t")
  ##Wtihout IDS:
    write.table(ASN_pheno_ordered_araclog2IC50_noids, "ASN_ordered_pheno_araclog2IC50_noids.txt", col.names = F, row.names = F, sep = "\t")
 
 
##make relationship matrix
gemma -g ASN.TGP_and_imputed.rmBAD.20130718.geno -p ASN_ordered_pheno_allfam_araclog2IC50_noids.txt -gk 1 -o ASN_relationship_matrix


#Create pheno files for GWAS, we have data for 4 of 8 drug phenos for ASN
 #Use file with all individuals:
  ASN_arac_pheno <- select(ASN_pheno_ordered_allfam, 1:13, - Pheno, contains("ARAC"))
  ASN_cape_pheno <- select(ASN_pheno_ordered_allfam, 1:13, - Pheno, contains("CAPE"))
  ASN_carbo_pheno <- select(ASN_pheno_ordered_allfam, 1:13, - Pheno, contains("CARBO"))
  ASN_cis_pheno <- select(ASN_pheno_ordered_allfam, 1:13, - Pheno, contains("CIS"))
 
 #isolate best phenotype: Example with CIS, repeat with other drug phenos
  With IDs:
  ASN_cisplatin_bestpheno <- select(ASN_cis_pheno, 1:12, contains("CIS_RnIC50"))
  write.table(ASN_cisplatin_bestpheno, "ASN_cisplatin_bestpheno.txt", col.names = T, row.names = F, sep = "/t")
    
  Without IDs:
  ASN_cisplatin_bestpheno_noids <- select(ASN_cisplatin_bestpheno, contains("CIS"))
  write.table(ASN_cisplatin_bestpheno_noids, "ASN_cisplatin_bestpheno_noids.txt", col.names = F, row.names = F, sep = "/t")
    

# Run predixcan V7



# 


